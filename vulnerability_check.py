import requests

def check_vulnerabilities(services):
    vulnerabilities = {}
    for port, service in services.items():
        if service != "unknown":
            response = requests.get(f"https://vulners.com/api/v3/search/lucene/?query={service}")
            if response.status_code == 200:
                data = response.json()
                vulnerabilities[port] = data['result']['documents'][:3]  # Top 3 vulnerabilities
            else:
                vulnerabilities[port] = "Error fetching CVE data"
        else:
            vulnerabilities[port] = "Unknown service"
    return vulnerabilities
